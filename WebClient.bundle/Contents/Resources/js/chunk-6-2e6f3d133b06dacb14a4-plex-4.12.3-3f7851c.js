(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{1698:function(e,t,r){"use strict";r.r(t);var n=r(9),a=r.n(n),i=r(7),o=r.n(i),s=(r(4),r(1)),c=r.n(s),u=r(1693),l=r(17),d=r(751),f=r(96),h=r(167),p=r(8),E=r.n(p),m=r(210),v=new Map;var g=function(e){var t=e.url,r=E.a.Deferred();if(v.has(t))r.resolve({url:t,certificate:v.get(t)});else{var n=new window.XMLHttpRequest,a=function(){n.removeEventListener("error",i,!1),n.removeEventListener("load",o,!1)},i=function(e){var n=e.target.status;a(),r.reject({url:t,status:n})},o=function(e){var n=e.target,i=n.response,o=n.status;if(a(),200===o){var s=new Uint8Array(i);r.resolve({url:t,certificate:s})}else r.reject({url:t,status:o})};n.responseType="arraybuffer",n.addEventListener("error",i,!1),n.addEventListener("load",o,!1),n.open("GET",t,!0),n.send()}return Object(m.a)(r.promise())};var C,R=function(e){var t=!1;return function(){if(!t)return t=!0,e.apply(void 0,arguments)}}(function(e){e.polyfill.installAll()}),y=r(2),T=r(10),_=r.n(T),A=c.a.createElement,w=function(e){function t(){for(var t,r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return(t=e.call.apply(e,[this].concat(n))||this).onTimeout=function(){var e=t.props,r=e.positionSeconds,n=e.durationSeconds,a=e.onEnd,i=n-r;l.a.warn("[Player] Manually ending while stalled within the last %ss.",i),t.props.onBufferingChange&&t.props.onBufferingChange(!1),a()},t}o()(t,e);var r=t.prototype;return r.componentDidUpdate=function(e){var t=this.props,r=t.healthCheckSecondsFromEnd,n=t.positionSeconds,a=t.durationSeconds,i=t.paused,o=t.onEnd,s=!1;o&&a>0&&n>=a&&(s=!0,o());var c=n!==e.positionSeconds,u=i&&i!==e.paused,l=s||c||u;this._timeoutID&&l&&clearTimeout(this._timeoutID);var d=a-n;if(a>0&&o&&(!s&&!i)&&d>=0&&d<r){var f=Math.round(1e3*d)+250;clearTimeout(this._timeoutID),this._timeoutID=setTimeout(this.onTimeout,f)}},r.componentWillUnmount=function(){this._timeoutID&&clearTimeout(this._timeoutID)},r.render=function(){var e=this.props,t=e.mediaComponent,r=_()(e,["mediaComponent"]);return A(t,r)},t}(c.a.Component),b=r(439),P=c.a.createElement,O=c.a.Component,S=u.util.Error,I=S.Category,M=S.Code,L=S.Severity;function D(e){switch(e){case I.NETWORK:return Object(y.default)("Network");case I.TEXT:return Object(y.default)("Text");case I.MEDIA:return Object(y.default)("Media");case I.MANIFEST:return Object(y.default)("Manifest");case I.STREAMING:return Object(y.default)("Streaming");case I.DRM:return Object(y.default)("DRM");case I.PLAYER:return Object(y.default)("Player");case I.CAST:return Object(y.default)("Cast");case I.STORAGE:return Object(y.default)("Storage");default:return Object(y.default)("Unknown")}}function k(e){return["s"+e.code+" ("+D(e.category)+")"].concat(function(e){var t=e.code,r=e.data;switch(t){case M.BAD_HTTP_STATUS:return["URI: "+r[0],r[1]?"Status code: "+r[1]:null,r[2]?"Response text: "+r[2]:null,r[3]?"Response headers: "+JSON.stringify(r[3],null,2):null,r[4]?"NetworkingEngine.RequestType: "+r[4]:null];case M.MEDIA_SOURCE_OPERATION_FAILED:return["MediaError code: "+r[0]];case M.MEDIA_SOURCE_OPERATION_THREW:return["DOMException "+r[0].name+": "+r[0].message];case M.VIDEO_ERROR:return["MediaError code: "+r[0],r[1]?"Edge/IE Error code: "+r[1]:null,r[2]?"Chrome error details: "+r[2]:null];case M.INIT_DATA_TRANSFORM_ERROR:return["Exception "+r[0].name+": "+r[0].message]}}(e)).filter(function(e){return e}).join(" â€“ ")}function N(e,t){var r,n,a,i={},o=d.a[e.drm];o===h.FAIRPLAY&&(i.fairPlayTransform=!1,i.advanced=((r={})[o]={serverCertificate:t},r),i.initDataTransform=function(e){return u.util.FairPlayUtils.initDataTransform(e,u.util.FairPlayUtils.defaultGetContentId(e),C.drmInfo().serverCertificate)});o&&(n=Object.assign({},i,{servers:(a={},a[o]=e.license,a)}));return n}var j=function(e){function t(t,r){var n;return(n=e.call(this,t,r)||this).onNetworkEngineRequest=function(e,t){if(e===u.net.NetworkingEngine.RequestType.LICENSE)switch(n.props.drm){case f.PLAYREADY:delete t.headers.SOAPAction}},n.onFetchCertificateResolved=function(e){var t=e.url,r=e.certificate;n._serverCertificate=r,l.a.warn("[Player] Server certificate request succeeeded: %s",t),n.tryLoadMedia()},n.onFetchCertificateRejected=function(e){var t=e.isCanceled,r=e.url,a=e.status;t||(l.a.warn("[Player] Server certificate request failed (%d): %s",a,r),n._serverCertificate="invalid",n.tryLoadMedia())},n.onElementChange=function(e){n._mediaElement=e,n.tryLoadMedia()},n.onHTMLError=function(){},n.onBufferingChange=function(e){e.buffering},n.onError=function(e){var t=e.detail,r=void 0===t?{}:t;if(!n._hasUnmounted){var a=r.category,i=r.code,o=r.severity,s=k(r),c=o;a===I.DRM&&i===M.INIT_DATA_TRANSFORM_ERROR&&o===L.CRITICAL&&(c=L.RECOVERABLE),c===L.CRITICAL?(l.a.warn("[Player] A critical Shaka error occurred: "+s+"; the player cannot recover"),n.props.onError&&n.props.onError({code:"s"+i,category:D(a)})):c===L.RECOVERABLE?l.a.warn("[Player] A Shaka error occurred: "+s+"; the player will attempt to recover"):l.a.warn("[Player] A Shaka error occurred: "+s+"; the severity is unknown")}},R(u),C||(C=new u.Player),n.state={isReadyToPlay:!1},n._mediaElement,n._serverCertificate,n._serverCertificateCancelable,n}o()(t,e);var r=t.prototype;return r.componentDidMount=function(){var e=this.props.certificate;e&&(this._serverCertificateCancelable=g({url:e}),this._serverCertificateCancelable.promise.then(this.onFetchCertificateResolved,this.onFetchCertificateRejected))},r.componentWillUnmount=function(){(this._hasUnmounted=!0,this._resetPrePlaybackFields(),C)&&(C.getNetworkingEngine().unregisterRequestFilter(this.onNetworkEngineRequest),C.resetConfiguration(),C.removeEventListener("buffering",this.onBufferingChange),C.removeEventListener("error",this.onError),C.detach(),C.unload())},r._resetPrePlaybackFields=function(){this._serverCertificateCancelable&&(this._serverCertificateCancelable.cancel(),delete this._serverCertificateCancelable),delete this._mediaElement,delete this._serverCertificate},r.tryLoadMedia=function(){var e=this._mediaElement,t=this._serverCertificate,r=this.props.drm===f.FAIRPLAY;!e||r&&!t||(this._resetPrePlaybackFields(),this.loadMedia({mediaElement:e,serverCertificate:t}))},r.loadMedia=function(e){var t=this,r=e.mediaElement,n=e.serverCertificate,a={streaming:{bufferingGoal:this.props.bufferingGoal,jumpLargeGaps:!0,retryParameters:{maxAttempts:1/0}},abr:{defaultBandwidthEstimate:this.props.defaultBandwidthEstimate},drm:N(this.props,n)};l.a.debug("[Player] Next configuration: %o",a),C.configure(a),C.attach(r),C.addEventListener("buffering",this.onBufferingChange),C.addEventListener("error",this.onError),C.getNetworkingEngine().registerRequestFilter(this.onNetworkEngineRequest),C.load(this.props.src,this.props.positionSeconds).then(function(){C&&t.setState({isReadyToPlay:!0})},function(e){C&&t.onError({detail:e})})},r.render=function(){return P(w,a()({},this.props,{healthCheckSecondsFromEnd:this.props.bufferingGoal,mediaComponent:b.a,isReadyToPlay:this.state.isReadyToPlay,onElementChange:this.onElementChange,onError:this.onHTMLError}))},t}(O);j.displayName="ShakaMedia",j.defaultProps=Object.assign({},b.a.defaultProps,{bufferingGoal:70});t.default=j}}]);