(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{1698:function(e,t,r){"use strict";r.r(t);var n=r(9),a=r.n(n),i=r(7),o=r.n(i),s=(r(4),r(1)),c=r.n(s),u=r(1693),l=r(17),d=r(140),f=r(250),h=r(8),p=r.n(h),E=r(207),m=new Map;var v=function(e){var t=e.url,r=p.a.Deferred();if(m.has(t))r.resolve({url:t,certificate:m.get(t)});else{var n=new window.XMLHttpRequest,a=function(){n.removeEventListener("error",i,!1),n.removeEventListener("load",o,!1)},i=function(e){var n=e.target.status;a(),r.reject({url:t,status:n})},o=function(e){var n=e.target,i=n.response,o=n.status;if(a(),200===o){var s=new Uint8Array(i);r.resolve({url:t,certificate:s})}else r.reject({url:t,status:o})};n.responseType="arraybuffer",n.addEventListener("error",i,!1),n.addEventListener("load",o,!1),n.open("GET",t,!0),n.send()}return Object(E.a)(r.promise())};var g,C=function(e){var t=!1;return function(){if(!t)return t=!0,e.apply(void 0,arguments)}}(function(e){e.polyfill.installAll()}),R=r(2),y=r(10),A=r.n(y),T=c.a.createElement,_=function(e){function t(){for(var t,r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return(t=e.call.apply(e,[this].concat(n))||this).onTimeout=function(){var e=t.props,r=e.positionSeconds,n=e.durationSeconds,a=e.onEnd,i=n-r;l.a.warn("[Player] Manually ending while stalled within the last %ss.",i),t.props.onBufferingChange&&t.props.onBufferingChange(!1),a()},t}o()(t,e);var r=t.prototype;return r.componentDidUpdate=function(e){var t=this.props,r=t.healthCheckSecondsFromEnd,n=t.positionSeconds,a=t.durationSeconds,i=t.paused,o=t.onEnd,s=!1;o&&a>0&&n>=a&&(s=!0,o());var c=n!==e.positionSeconds,u=i&&i!==e.paused,l=s||c||u;this._timeoutID&&l&&clearTimeout(this._timeoutID);var d=a-n;if(a>0&&o&&(!s&&!i)&&d>=0&&d<r){var f=Math.round(1e3*d)+250;clearTimeout(this._timeoutID),this._timeoutID=setTimeout(this.onTimeout,f)}},r.componentWillUnmount=function(){this._timeoutID&&clearTimeout(this._timeoutID)},r.render=function(){var e=this.props,t=e.mediaComponent,r=A()(e,["mediaComponent"]);return T(t,r)},t}(c.a.Component),w=r(438),b=c.a.createElement,I=c.a.Component,P=u.util.Error,O=P.Category,S=P.Code,L=P.Severity;function M(e){switch(e){case O.NETWORK:return Object(R.default)("Network");case O.TEXT:return Object(R.default)("Text");case O.MEDIA:return Object(R.default)("Media");case O.MANIFEST:return Object(R.default)("Manifest");case O.STREAMING:return Object(R.default)("Streaming");case O.DRM:return Object(R.default)("DRM");case O.PLAYER:return Object(R.default)("Player");case O.CAST:return Object(R.default)("Cast");case O.STORAGE:return Object(R.default)("Storage");default:return Object(R.default)("Unknown")}}function D(e){return["s"+e.code+" ("+M(e.category)+")"].concat(function(e){var t=e.code,r=e.data;switch(t){case S.BAD_HTTP_STATUS:return["URI: "+r[0],r[1]?"Status code: "+r[1]:null,r[2]?"Response text: "+r[2]:null,r[3]?"Response headers: "+JSON.stringify(r[3],null,2):null,r[4]?"NetworkingEngine.RequestType: "+r[4]:null];case S.MEDIA_SOURCE_OPERATION_FAILED:return["MediaError code: "+r[0]];case S.MEDIA_SOURCE_OPERATION_THREW:return["DOMException "+r[0].name+": "+r[0].message];case S.VIDEO_ERROR:return["MediaError code: "+r[0],r[1]?"Edge/IE Error code: "+r[1]:null,r[2]?"Chrome error details: "+r[2]:null];case S.INIT_DATA_TRANSFORM_ERROR:return["Exception "+r[0].name+": "+r[0].message]}}(e)).filter(function(e){return e}).join(" â€“ ")}function N(e,t){var r,n,a,i,o={};switch(e.drm){case d.FAIRPLAY:n=f.FAIRPLAY_NATIVE,o.fairPlayTransform=!1,o.advanced=((r={})[n]={serverCertificate:t},r),o.initDataTransform=function(e){return u.util.FairPlayUtils.initDataTransform(e,u.util.FairPlayUtils.defaultGetContentId(e),g.drmInfo().serverCertificate)};break;case d.PLAYREADY:n=f.PLAYREADY;break;case d.WIDEVINE:n=f.WIDEVINE}n&&(a=Object.assign({},o,{servers:(i={},i[n]=e.license,i)}));return a}var k=function(e){function t(t,r){var n;return(n=e.call(this,t,r)||this).onNetworkEngineRequest=function(e,t){if(e===u.net.NetworkingEngine.RequestType.LICENSE)switch(n.props.drm){case d.PLAYREADY:delete t.headers.SOAPAction}},n.onFetchCertificateResolved=function(e){var t=e.url,r=e.certificate;n._serverCertificate=r,l.a.warn("[Player] Server certificate request succeeeded: %s",t),n.tryLoadMedia()},n.onFetchCertificateRejected=function(e){var t=e.isCanceled,r=e.url,a=e.status;t||(l.a.warn("[Player] Server certificate request failed (%d): %s",a,r),n._serverCertificate="invalid",n.tryLoadMedia())},n.onElementChange=function(e){n._mediaElement=e,n.tryLoadMedia()},n.onHTMLError=function(){},n.onBufferingChange=function(e){e.buffering},n.onError=function(e){var t=e.detail,r=void 0===t?{}:t;if(!n._hasUnmounted){var a=r.category,i=r.code,o=r.severity,s=D(r),c=o;a===O.DRM&&i===S.INIT_DATA_TRANSFORM_ERROR&&o===L.CRITICAL&&(c=L.RECOVERABLE),c===L.CRITICAL?(l.a.warn("[Player] A critical Shaka error occurred: "+s+"; the player cannot recover"),n.props.onError&&n.props.onError({code:"s"+i,category:M(a)})):c===L.RECOVERABLE?l.a.warn("[Player] A Shaka error occurred: "+s+"; the player will attempt to recover"):l.a.warn("[Player] A Shaka error occurred: "+s+"; the severity is unknown")}},C(u),g||(g=new u.Player),n.state={isReadyToPlay:!1},n._mediaElement,n._serverCertificate,n._serverCertificateCancelable,n}o()(t,e);var r=t.prototype;return r.componentDidMount=function(){var e=this.props.certificate;e&&(this._serverCertificateCancelable=v({url:e}),this._serverCertificateCancelable.promise.then(this.onFetchCertificateResolved,this.onFetchCertificateRejected))},r.componentWillUnmount=function(){(this._hasUnmounted=!0,this._resetPrePlaybackFields(),g)&&(g.getNetworkingEngine().unregisterRequestFilter(this.onNetworkEngineRequest),g.resetConfiguration(),g.removeEventListener("buffering",this.onBufferingChange),g.removeEventListener("error",this.onError),g.detach(),g.unload())},r._resetPrePlaybackFields=function(){this._serverCertificateCancelable&&(this._serverCertificateCancelable.cancel(),delete this._serverCertificateCancelable),delete this._mediaElement,delete this._serverCertificate},r.tryLoadMedia=function(){var e=this._mediaElement,t=this._serverCertificate,r=this.props.drm===d.FAIRPLAY;!e||r&&!t||(this._resetPrePlaybackFields(),this.loadMedia({mediaElement:e,serverCertificate:t}))},r.loadMedia=function(e){var t=this,r=e.mediaElement,n=e.serverCertificate,a={streaming:{bufferingGoal:this.props.bufferingGoal,jumpLargeGaps:!0,retryParameters:{maxAttempts:1/0}},abr:{defaultBandwidthEstimate:this.props.defaultBandwidthEstimate},drm:N(this.props,n)};Object(l.a)("[Player] Next configuration: %o",a),g.configure(a),g.attach(r),g.addEventListener("buffering",this.onBufferingChange),g.addEventListener("error",this.onError),g.getNetworkingEngine().registerRequestFilter(this.onNetworkEngineRequest),g.load(this.props.src,this.props.positionSeconds).then(function(){g&&t.setState({isReadyToPlay:!0})},function(e){g&&t.onError({detail:e})})},r.render=function(){return b(_,a()({},this.props,{healthCheckSecondsFromEnd:this.props.bufferingGoal,mediaComponent:w.a,isReadyToPlay:this.state.isReadyToPlay,onElementChange:this.onElementChange,onError:this.onHTMLError}))},t}(I);k.displayName="ShakaMedia",k.defaultProps=Object.assign({},w.a.defaultProps,{bufferingGoal:70});t.default=k}}]);